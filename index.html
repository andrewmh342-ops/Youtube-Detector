<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aeroblade ë”¥í˜ì´í¬ íƒì§€ê¸°</title>
    <style>
        body { font-family: 'Apple SD Gothic Neo', sans-serif; text-align: center; padding: 50px; background-color: #f0f2f5; }
        #drop-area { 
            border: 3px dashed #ccc; border-radius: 20px; width: 80%; max-width: 500px; 
            margin: 0 auto; padding: 60px 20px; cursor: pointer; background-color: white; 
            transition: all 0.3s;
        }
        #drop-area.highlight { border-color: #6c5ce7; background-color: #eef1ff; transform: scale(1.02); }
        #result { font-weight: bold; font-size: 1.5em; margin-top: 30px; }
        #details { font-size: 0.9em; color: #555; background: #fff; padding: 15px; border-radius: 10px; display: none; margin-top: 10px; border: 1px solid #ddd; }
        .danger { color: #e74c3c; }
        .safe { color: #27ae60; }
        .loading { color: #3498db; }
        #preview { max-width: 100%; max-height: 200px; margin: 20px auto; display: none; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
    </style>
</head>
<body>
    <h1>ğŸ•µï¸â€â™€ï¸ Aeroblade ë”¥í˜ì´í¬ íƒì§€</h1>
    <p>ì´ë¯¸ì§€ì˜ ë³µì› ì˜¤ì°¨ë¥¼ ë¶„ì„í•˜ì—¬ AI ìƒì„± ì—¬ë¶€ë¥¼ íŒë³„í•©ë‹ˆë‹¤.</p>

    <div id="drop-area">
        <p id="instruction">ğŸ“· ì´ë¯¸ì§€ë¥¼ ì—¬ê¸°ì— ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì„¸ìš”</p>
        <input type="file" id="fileElem" accept="image/*" style="display:none" onchange="handleFiles(this.files)">
        <img id="preview" src="" alt="ë¯¸ë¦¬ë³´ê¸°">
    </div>

    <div id="result-container">
        <div id="result"></div>
        <div id="details"></div>
    </div>

    <script>
        const dropArea = document.getElementById('drop-area');
        const fileElem = document.getElementById('fileElem');
        const previewImg = document.getElementById('preview');
        const resultDiv = document.getElementById('result');
        const detailsDiv = document.getElementById('details');
        const instruction = document.getElementById('instruction');

        // í´ë¦­ìœ¼ë¡œ íŒŒì¼ ì—´ê¸°
        dropArea.addEventListener('click', () => fileElem.click());

        // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ê¸°ë³¸ ë™ì‘ ë°©ì§€ (ë¸Œë¼ìš°ì €ê°€ íŒŒì¼ì„ ì§ì ‘ ì—¬ëŠ” ê²ƒ ë°©ì§€)
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, preventDefaults, false);
        });

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        // ë“œë˜ê·¸ ê°•ì¡° íš¨ê³¼
        ['dragenter', 'dragover'].forEach(eventName => {
            dropArea.addEventListener(eventName, () => dropArea.classList.add('highlight'), false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, () => dropArea.classList.remove('highlight'), false);
        });

        // íŒŒì¼ì„ ë†“ì•˜ì„ ë•Œ ì²˜ë¦¬
        dropArea.addEventListener('drop', (e) => {
            const dt = e.dataTransfer;
            const files = dt.files;
            handleFiles(files);
        }, false);

        function handleFiles(files) {
            const file = files[0];
            if (!file) return;

            // ë¯¸ë¦¬ë³´ê¸° í‘œì‹œ
            const reader = new FileReader();
            reader.onload = (e) => { 
                previewImg.src = e.target.result; 
                previewImg.style.display = 'block';
                instruction.style.display = 'none';
            };
            reader.readAsDataURL(file);

            uploadFile(file);
        }

        async function uploadFile(file) {
            const url = 'https://hee-unsyncopated-adrianna.ngrok-free.dev/predict'; 
            const formData = new FormData();
            formData.append('file', file);

            resultDiv.innerHTML = '<span class="loading">â³ ì¸ê³µì§€ëŠ¥ì´ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤...</span>';
            detailsDiv.style.display = 'none';

            try {
                let response = await fetch(url, { method: 'POST', body: formData });
                let data = await response.json();
                
                if (data.is_fake) {
                    resultDiv.innerHTML = `<span class="danger">ğŸš¨ ${data.result}</span>`;
                    detailsDiv.innerHTML = `ì˜¤ì°¨ ì ìˆ˜: <b>${data.score}</b><br>(ê¸°ì¤€ ${data.threshold} ë¯¸ë§Œìœ¼ë¡œ ê°€ì§œ ì˜ì‹¬)`;
                } else {
                    resultDiv.innerHTML = `<span class="safe">âœ… ${data.result}</span>`;
                    detailsDiv.innerHTML = `ì˜¤ì°¨ ì ìˆ˜: <b>${data.score}</b><br>(ê¸°ì¤€ ${data.threshold} ì´ìƒìœ¼ë¡œ ì§„ì§œ ì‚¬ì§„ íŒì •)`;
                }
                detailsDiv.style.display = 'inline-block';
            } catch (error) {
                resultDiv.innerHTML = "<span class='danger'>âŒ ì„œë²„ ì—°ê²° ì‹¤íŒ¨ (ngrok ì£¼ì†Œë¥¼ í™•ì¸í•˜ì„¸ìš”)</span>";
                console.error(error);
            }
        }
    </script>
</body>
</html>