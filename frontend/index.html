<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>이미지 전송 테스트</title>
  </head>
  <body>
    <h2>1단계: 이미지 전송 테스트</h2>

    <input type="file" id="imageInput" accept="image/*" />
    <br /><br />
    <button onclick="sendImage()">서버로 전송하기</button>

    <h3 id="result">대기 중...</h3>

    <script>
      async function sendImage() {
        const input = document.getElementById('imageInput');
        const resultText = document.getElementById('result');

        if (input.files.length === 0) {
          alert('이미지를 선택해주세요!');
          return;
        }

        const file = input.files[0];
        const formData = new FormData();
        formData.append('file', file);

        resultText.innerText = '전송 중...';

        try {
          // 중요: 로컬 서버 주소로 데이터를 보냅니다.
          const response = await fetch('http://127.0.0.1:8000/upload', {
            method: 'POST',
            body: formData,
          });

          const data = await response.json();
          console.log(data); // 브라우저 콘솔 확인용

          if (response.ok) {
            resultText.innerText = '성공! 서버 응답: ' + data.info;
            resultText.style.color = 'green';
          } else {
            resultText.innerText = '실패...';
            resultText.style.color = 'red';
          }
        } catch (error) {
          console.error('Error:', error);
          resultText.innerText = '에러 발생! 서버가 켜져 있나요?';
          resultText.style.color = 'red';
        }
      }
    </script>
  </body>
</html>
